---
description: "Execute lifecycle recommendations from literature-review.md (stock promotion, archive, consolidation)"
argument-hint: "[project-name]"
---

# Curate: Batch Execute Literature Review Recommendations

Read lifecycle recommendations (stock promotion candidates, archive candidates, consolidation candidates, needs update) from `literature-review.md` generated by `/expand`, and batch-execute approved operations.

Target project: $ARGUMENTS (ask if not specified)

---

## Phase 1: Prerequisites Check

1. Identify project name from `$ARGUMENTS` (if not specified, list projects under `flow/` and confirm)
2. Check existence of `flow/<project>/literature-review.md`
   - **Missing**: Suggest "`/expand <project>` to run Literature Review first" and exit
   - **Present**: Read `Last updated` timestamp
3. **Freshness check**: Compare file modification dates in `flow/<project>/` and `stock/<project>/`
   - If files newer than literature-review.md exist, warn and confirm whether to continue
4. Read `literature-review.md` in full
5. Read `flow/<project>/README.md` (section 8 file inventory, section 9 next actions â€” for later update)
6. Read `stock/<project>/README.md` if it exists (for README update on promote)

## Phase 2: Action Plan Extraction

Extract "lifecycle recommendation" from each file in `literature-review.md` and classify into 5 categories:

| Category | Recommendation Value | Operation |
|----------|---------------------|-----------|
| **promote** | `stock promotion candidate` | `git mv flow/ -> stock/` + stock README update |
| **archive** | `archive candidate` | `git mv -> archive/` |
| **consolidate** | `consolidation candidate` | AI-generated merge -> source archive |
| **update** | `needs update` | No operation, information only for user |
| **keep** | `maintain` | No operation |

**Dependency resolution:**
- File is both "promote candidate" and "consolidation source" -> prioritize consolidation (consolidation result becomes promote target)
- File is both "archive candidate" and "consolidation source" -> auto-archive after consolidation (no separate archive action needed)
- Newly created consolidation files -> place in flow/ (as draft. Promote in next `/curate` if needed)

**Extract additional info from cross-file analysis section:**
- Duplicate pairs -> add to consolidation candidates (if not in individual recommendations)
- Contradiction flags -> retain as warnings during consolidation

## Phase 3: User Confirmation Gate

Present all actions in a table:

```
## /curate Action Plan: <project>
> literature-review.md updated: YYYY-MM-DD

### Summary
| Action | Count |
|--------|-------|
| Stock promotion | N |
| Archive | N |
| Consolidation | N groups |
| Needs update (info only) | N |
| Maintain | N |

### Stock Promotion (N items)
| # | File | Current Location | Reason |
|---|------|-----------------|--------|
| P1 | xxx.md | flow/<project>/ | ... |

### Archive (N items)
| # | File | Current Location | Reason |
|---|------|-----------------|--------|
| A1 | dr-xxx.md | flow/<project>/ | ... |

### Consolidation (N groups)
| # | Source Files | Target (new) | Reason |
|---|-------------|--------------|--------|
| C1 | file-a.md + file-b.md | combined-analysis.md | ... |

### Needs Update (info only)
| # | File | Concern |
|---|------|---------|
| U1 | dr-xxx.md | ... |
```

Ask user to approve, modify, or skip each item:
- Example: "Approve P1, skip P2, rename C1 target to xxx"
- **Get approval before proceeding to Phase 4**

## Phase 4: Consolidation Execution (if applicable)

For each approved consolidation group:

### Step 4a: Source Reading and Structure Proposal

1. Read all source files thoroughly
2. Identify duplicate sections, unique sections, contradictions
3. Present consolidation structure proposal to user:
   ```
   #### C1: <target-name>.md Structure Proposal
   Sources: file-a.md (XXkb), file-b.md (XXkb)
   Proposed structure:
   1. Executive summary (new)
   2. Section A (based on file-a.md)
   3. Section B (based on file-b.md)
   4. Cross-cutting analysis (new: integrating data from both sources)
   Contradictions detected: yes/no
   ```
4. Get structure approval

### Step 4b: Generate Consolidated Document

1. Generate consolidated document following approved structure
2. Add source header:
   ```markdown
   > Consolidated from: file-a.md, file-b.md
   > Consolidation date: YYYY-MM-DD
   > Review status: Draft (needs review)
   ```
3. Accurately transcribe data, figures, and citations from originals
4. Save to `flow/<project>/<target-name>.md`
5. `git add flow/<project>/<target-name>.md`

### Step 4c: Consolidation Review (User Gate)

- Present key points of generated document
- User approves -> move source files to archive
- User requests modifications -> modify and re-present
- User rejects -> skip this consolidation, keep source files as-is

### Step 4d: Archive Source Files

After approval:
```bash
git mv flow/<project>/<source-a>.md archive/<source-a>.md
git mv flow/<project>/<source-b>.md archive/<source-b>.md
```

## Phase 5: Promote / Archive Execution

### Step 5a: Archive (non-consolidation)

Execute approved archive actions:
```bash
git mv flow/<project>/<file> archive/<file>
```
- Archive destination: `archive/` root (flat). If 5+ files, create `archive/<project>/`

### Step 5b: Promote

Execute approved promote actions:
1. Create `stock/<project>/` directory if needed with `mkdir -p`
2. `git mv flow/<project>/<file> stock/<project>/<file>`

**Stock README.md update** (replicating `/promote` Step 4 logic):

- **If no README.md**:
  1. Generate MoC format based on section 1 and section 6 from `flow/<project>/README.md`
  2. Template reference: `stock/reference/templates/project-charter-stock.md`
  3. Populate file inventory table with promoted files
  4. Confirm recommended reading order with user
  5. `git add stock/<project>/README.md`

- **If README.md exists**:
  1. Add newly promoted files to file inventory table
  2. `git add stock/<project>/README.md`

## Phase 6: Finalize

1. **Update flow README.md section 8**: Remove entries for promoted/archived files, add entries for newly consolidated files
2. **Update flow README.md section 9**: Reflect curation results in next actions
3. `git add flow/<project>/README.md`
4. **Domain knowledge check** (replicating `/promote` Step 5):
   - If promoted files contain new organizational facts, propose updates to `stock/reference/context/org-knowledge.md`
5. Display all staged content with `git status`
6. Completion summary:
   ```
   ## /curate Complete: <project>
   | Action | Count | Files |
   |--------|-------|-------|
   | Stock promotion | N | ... |
   | Archive | N | ... |
   | Consolidation (new) | N | ... |
   | README updates | N | ... |

   Changes are not committed. Run `git commit` after review.
   Run `/expand <project>` to re-evaluate.
   ```

## Edge Cases

| Case | Response |
|------|----------|
| No actionable recommendations | Report "All files maintain current status" and suggest re-running `/expand` |
| Referenced file not found | Skip with warning (may have been moved manually) |
| Promote target has same-name file | Ask user to overwrite or rename |
| Consolidation target name conflicts with existing | Propose alternative name |
| flow/ becomes empty after all operations | Suggest directory deletion, note project may be complete |
